<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ© - Ø³Ø­Ø¨ ÙˆØ¥ÙÙ„Ø§Øª</title>
    <!-- ØªØ¶Ù…ÙŠÙ† Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ØªØ¶Ù…ÙŠÙ† Ø§Ù„Ø®Ø· (Tajawal) Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f0fdf4;
        }
        .drop-zone {
            border: 3px dashed #16a34a;
            min-height: 20vh; 
            transition: all 0.3s ease;
        }
        .drop-zone.active {
            background-color: #dcfce7;
            border-color: #65a30d;
        }
        .draggable {
            cursor: grab;
            transition: transform 0.1s ease-out, box-shadow 0.2s;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            position: relative;
        }
        .draggable:active {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        .item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }
        .drop-zone > .draggable {
            height: auto !important; 
        }
        .drop-zone svg {
            transition: opacity 0.3s;
        }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        .grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }

        @media (min-width: 768px) {
            .md\:grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
        }
        
        .pulse-animation {
            animation: pulse-red 1s infinite alternate;
        }
        @keyframes pulse-red {
            from { transform: scale(1); opacity: 1; }
            to { transform: scale(1.1); opacity: 0.8; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col p-4 md:p-8">

    <header class="text-center mb-6 relative">
        <h1 class="text-4xl font-extrabold text-green-700 mb-2">Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©</h1>
        
        <!-- Ø²Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ØµÙˆØª -->
        <button id="sound-toggle-btn" onclick="toggleSound()"
                class="absolute top-0 right-0 p-2 rounded-full bg-gray-200 hover:bg-gray-300 transition duration-150 shadow-md">
            <svg id="sound-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-2">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
            </svg>
        </button>

        <p id="level-description" class="text-xl text-green-600 font-semibold mb-2">...</p> 
        
        <!-- Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª (Lives) ÙˆØ´Ø±ÙŠØ· Ø§Ù„ÙˆÙ‚Øª (Time Bar) -->
        <div class="flex flex-col items-center justify-center mt-4">
            <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª -->
            <div class="flex items-center gap-1 mb-3" id="lives-container">
                <!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù‚Ù„ÙˆØ¨ Ù‡Ù†Ø§ Ø¹Ø¨Ø± JavaScript -->
            </div>

            <!-- Ø´Ø±ÙŠØ· Ø§Ù„ÙˆÙ‚Øª -->
            <div class="w-full max-w-lg bg-gray-200 rounded-full h-4 relative shadow-inner">
                <div id="time-bar" class="bg-green-500 h-4 rounded-full transition-all duration-1000 ease-linear" style="width: 100%"></div>
                <div id="time-text-container" class="absolute -top-6 w-full flex justify-center">
                    <span id="time-text" class="text-sm font-bold text-gray-700 bg-white px-2 rounded-md shadow-sm border border-gray-200">00:30</span>
                </div>
            </div>
        </div>

        <div id="message" class="text-lg p-3 rounded-lg font-medium hidden mt-4"></div>
    </header>

    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ -->
    <section class="mb-8 flex justify-center space-x-4 space-x-reverse">
        <button id="level1-btn" onclick="loadLevel('level1')" 
                class="bg-green-700 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 shadow-md">
            Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1 (3 Ø­Ù„Ù‚Ø§Øª)
        </button>
        <button id="level2-btn" onclick="loadLevel('level2')" 
                class="bg-indigo-700 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 shadow-md">
            Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2 (4 Ø­Ù„Ù‚Ø§Øª) ğŸ”’
        </button>
        <button id="level3-btn" onclick="loadLevel('level3')" 
                class="bg-red-700 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full transition duration-300 shadow-md">
            Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3 (5 Ø­Ù„Ù‚Ø§Øª) ğŸ”’
        </button>
    </section>

    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø© -->
    <section class="mb-8 p-4 bg-green-100 rounded-xl shadow-inner max-w-7xl mx-auto w-full relative">
        <h2 class="text-xl font-bold text-green-700 mb-4 text-center">Ø§Ø³Ø­Ø¨ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø³Ù„Ø©</h2>
        <div id="draggable-items-container" class="flex flex-wrap justify-center gap-4">
            
            <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
            <div id="grass" data-item="grass" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-green-500 rounded-lg w-28 h-32 text-center">
                <img src="grass.svg" alt="Ø¹Ø´Ø¨" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-green-800">Ø¹Ø´Ø¨</span>
            </div>
            <div id="algae" data-item="algae" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-cyan-500 rounded-lg w-28 h-32 text-center">
                <img src="algae.svg" alt="Ø·Ø­Ø§Ù„Ø¨" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-cyan-800">Ø·Ø­Ø§Ù„Ø¨</span>
            </div>

            <!-- Ù…Ø³ØªÙ‡Ù„Ùƒ Ø£ÙˆÙ„ -->
            <div id="grasshopper" data-item="grasshopper" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-yellow-600 rounded-lg w-28 h-32 text-center">
                <img src="grasshopper.svg" alt="Ø¬Ø±Ø§Ø¯Ø©" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-yellow-900">Ø¬Ø±Ø§Ø¯Ø©</span>
            </div>
            <div id="worm" data-item="worm" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-amber-600 rounded-lg w-28 h-32 text-center">
                <img src="worm.svg" alt="Ø¯ÙˆØ¯Ø©" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-amber-900">Ø¯ÙˆØ¯Ø©</span>
            </div>
            <div id="rabbit" data-item="rabbit" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-gray-400 rounded-lg w-28 h-32 text-center">
                <img src="rabbit.svg" alt="Ø£Ø±Ù†Ø¨" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-gray-700">Ø£Ø±Ù†Ø¨</span>
            </div>
            <div id="mouse" data-item="mouse" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-stone-400 rounded-lg w-28 h-32 text-center">
                <img src="mouse.svg" alt="ÙØ£Ø±" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-stone-700">ÙØ£Ø±</span>
            </div>
            
            <!-- Ù…Ø³ØªÙ‡Ù„Ùƒ Ø«Ø§Ù†Ù -->
            <div id="small_fish" data-item="small_fish" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-blue-500 rounded-lg w-28 h-32 text-center">
                <img src="fish.svg" alt="Ø³Ù…ÙƒØ© ØµØºÙŠØ±Ø©" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-blue-800">Ø³Ù…ÙƒØ© ØµØºÙŠØ±Ø©</span>
            </div>
            <div id="frog" data-item="frog" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-emerald-500 rounded-lg w-28 h-32 text-center">
                <img src="frog.svg" alt="Ø¶ÙØ¯Ø¹" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-emerald-800">Ø¶ÙØ¯Ø¹</span>
            </div>
            <div id="bird" data-item="bird" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-sky-500 rounded-lg w-28 h-32 text-center">
                <img src="bird.svg" alt="Ø¹ØµÙÙˆØ±" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-sky-800">Ø¹ØµÙÙˆØ±</span>
            </div>

            <!-- Ù…Ø³ØªÙ‡Ù„Ùƒ Ø«Ø§Ù„Ø« ÙˆØ±Ø§Ø¨Ø¹ -->
            <div id="snake" data-item="snake" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-red-600 rounded-lg w-28 h-32 text-center">
                <img src="snake.svg" alt="Ø«Ø¹Ø¨Ø§Ù†" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-red-900">Ø«Ø¹Ø¨Ø§Ù†</span>
            </div>
            <div id="hawk" data-item="hawk" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-orange-600 rounded-lg w-28 h-32 text-center">
                <img src="hawk.svg" alt="ØµÙ‚Ø±" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-orange-900">ØµÙ‚Ø±</span>
            </div>
            <div id="crocodile" data-item="crocodile" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-green-800 rounded-lg w-28 h-32 text-center">
                <img src="crocodile.svg" alt="ØªÙ…Ø³Ø§Ø­" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-green-900">ØªÙ…Ø³Ø§Ø­</span>
            </div>
            <div id="shark" data-item="shark" draggable="true" class="draggable flex flex-col items-center p-3 bg-white border-b-4 border-indigo-800 rounded-lg w-28 h-32 text-center">
                <img src="shark.svg" alt="Ø³Ù…Ùƒ Ù‚Ø±Ø´" class="item-image mb-1" />
                <span class="mt-2 text-sm font-semibold text-indigo-900">Ø³Ù…Ùƒ Ù‚Ø±Ø´</span>
            </div>

        </div>
    </section>

    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥ÙÙ„Ø§Øª (Drop Zones) -->
    <main class="flex-grow flex items-center justify-center">
        <div id="drop-area" class="grid w-full max-w-7xl p-6 bg-white rounded-xl shadow-2xl gap-4 md:gap-8">
            <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¥ÙÙ„Ø§Øª Ù‡Ù†Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
        </div>
    </main>
    
    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
    <section class="mt-6 flex justify-center">
        <button onclick="checkFoodChain()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-full transition duration-300 shadow-lg hover:shadow-xl text-lg">
            ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
        </button>
        <button onclick="clearBoard()" class="ml-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-full transition duration-300 shadow-lg text-lg">
            Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø³Ù„Ø©
        </button>
    </section>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ÙÙˆØ² ÙˆØ§Ù„Ø®Ø³Ø§Ø±Ø© -->
    <div id="result-screen" class="fixed inset-0 bg-black bg-opacity-70 z-50 hidden flex-col items-center justify-center backdrop-blur-sm transition-opacity duration-500">
        <div class="bg-white p-10 rounded-3xl text-center max-w-sm w-full mx-4 shadow-2xl transform transition-all border-4 border-white relative">
            <div id="result-icon" class="text-7xl mb-6 drop-shadow-md"></div>
            <h2 id="result-title" class="text-3xl font-extrabold mb-4 text-gray-800"></h2>
            <p id="result-message" class="text-lg text-gray-600 font-medium"></p>
            
            <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙÙˆØ² -->
            <div id="reward-container" class="hidden mt-6">
                <p class="text-sm text-gray-500 mb-4">Ø¬Ø§Ø±ÙŠ Ù†Ù‚Ù„Ùƒ Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©...</p>
                <div class="flex justify-center mb-4">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"></div>
                </div>
                <a href="https://talented-nation.github.io/database/sreward2.html" class="inline-flex items-center justify-center gap-2 bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-full transition-all shadow-md w-full">
                    <span>Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„Ø¢Ù†</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                </a>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ù„Ù„Ø¹Ø¨Ø©
        let draggedItem = null;
        let CURRENT_LEVEL = 'level1';
        let maxUnlockedLevel = 1; // 1 = level1, 2 = level2, 3 = level3
        let lives = 3;
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙˆÙ‚Øª
        let timerInterval;
        let timeLimit = 30; // Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        let timeLeft = 30;

        const messageBox = document.getElementById('message');
        const draggableArea = document.getElementById('draggable-items-container'); 
        const dropArea = document.getElementById('drop-area');
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØµÙˆØª
        let isSoundMuted = false;
        let successAudio = null;
        let failureAudio = null;
        let dragAudio = null;
        
        // ------------------------------------------------------------------
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£ØµÙˆØ§Øª
        // ------------------------------------------------------------------
        function createWavDataURL(frequency, durationSec, volume = 0.5) {
            const sampleRate = 44100;
            const numSamples = sampleRate * durationSec;
            const buffer = new ArrayBuffer(44 + numSamples * 2);
            const view = new DataView(buffer);
            
            const writeString = (view, offset, string) => {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            };

            writeString(view, 0, 'RIFF'); 
            view.setUint32(4, 36 + numSamples * 2, true); 
            writeString(view, 8, 'WAVE'); 
            writeString(view, 12, 'fmt '); 
            view.setUint32(16, 16, true); 
            view.setUint16(20, 1, true); 
            view.setUint16(22, 1, true); 
            view.setUint32(24, sampleRate, true); 
            view.setUint32(28, sampleRate * 2, true); 
            view.setUint16(32, 2, true); 
            view.setUint16(34, 16, true); 
            writeString(view, 36, 'data'); 
            view.setUint32(40, numSamples * 2, true); 

            let offset = 44;
            const maxAmplitude = 32767 * volume;
            for (let i = 0; i < numSamples; i++) {
                const time = i / sampleRate;
                const sample = maxAmplitude * Math.sin(2 * Math.PI * frequency * time);
                view.setInt16(offset, sample, true); 
                offset += 2;
            }

            const blob = new Blob([view], { type: 'audio/wav' });
            return URL.createObjectURL(blob);
        }

        function initAudio() {
            successAudio = new Audio(createWavDataURL(587.33, 0.15, 0.7)); 
            successAudio.volume = isSoundMuted ? 0 : 1;
            
            failureAudio = new Audio(createWavDataURL(110.0, 0.3, 0.7)); 
            failureAudio.volume = isSoundMuted ? 0 : 1;
            
            dragAudio = new Audio(createWavDataURL(440.0, 0.05, 0.5)); 
            dragAudio.volume = isSoundMuted ? 0 : 1;
        }

        function toggleSound() {
            isSoundMuted = !isSoundMuted;
            const iconContainer = document.getElementById('sound-toggle-btn');
            
            const iconOn = `<svg id="sound-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg>`;
            const iconOff = `<svg id="sound-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-volume-x"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="22" x2="16" y1="9" y2="15"/><line x1="16" x2="22" y1="9" y2="15"/></svg>`;

            iconContainer.innerHTML = isSoundMuted ? iconOff : iconOn;

            if (successAudio) successAudio.volume = isSoundMuted ? 0 : 1;
            if (failureAudio) failureAudio.volume = isSoundMuted ? 0 : 1;
            if (dragAudio) dragAudio.volume = isSoundMuted ? 0 : 1;
        }

        function playSuccessSound() { 
            if (successAudio && !isSoundMuted) { 
                successAudio.currentTime = 0; 
                const playPromise = successAudio.play(); 
                if (playPromise !== undefined) {
                    playPromise.catch(error => { console.warn("Audio playback prevented:", error); });
                }
            } 
        }
        function playFailureSound() { 
            if (failureAudio && !isSoundMuted) { 
                failureAudio.currentTime = 0; 
                const playPromise = failureAudio.play(); 
                if (playPromise !== undefined) {
                    playPromise.catch(error => { console.warn("Audio playback prevented:", error); });
                }
            } 
        }
        function playDragSound() { 
            if (dragAudio && !isSoundMuted) { 
                dragAudio.currentTime = 0; 
                const playPromise = dragAudio.play(); 
                if (playPromise !== undefined) {
                    playPromise.catch(error => { console.warn("Audio playback prevented:", error); });
                }
            } 
        }

        // ------------------------------------------------------------------
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        // ------------------------------------------------------------------
        const CORRECT_CHAINS = {
            'level1': [
                ['algae', 'small_fish', 'crocodile'], 
                ['grass', 'grasshopper', 'bird'],     
                ['grass', 'mouse', 'snake'],          
                ['grass', 'mouse', 'hawk'],           
                ['grass', 'worm', 'bird'],            
                ['grass', 'grasshopper', 'frog'],     
                ['grass', 'rabbit', 'hawk'],          
                ['grass', 'rabbit', 'snake'],         
                ['algae', 'small_fish', 'shark']      
            ], 
            'level2': [
                ['grass', 'grasshopper', 'frog', 'snake'],      
                ['grass', 'grasshopper', 'frog', 'crocodile'],  
                ['grass', 'mouse', 'snake', 'hawk'],            
                ['grass', 'rabbit', 'snake', 'hawk'],           
                ['grass', 'worm', 'bird', 'hawk'],              
                ['algae', 'small_fish', 'frog', 'crocodile'],   
                ['grass', 'grasshopper', 'bird', 'hawk'],       
                ['grass', 'grasshopper', 'bird', 'snake'],      
                ['grass', 'worm', 'bird', 'snake']              
            ], 
            'level3': [
                ['grass', 'worm', 'frog', 'snake', 'hawk'],              
                ['grass', 'grasshopper', 'frog', 'snake', 'hawk'], 
                ['grass', 'grasshopper', 'bird', 'snake', 'hawk'],      
                ['grass', 'worm', 'bird', 'snake', 'hawk'],             
                ['algae', 'small_fish', 'frog', 'snake', 'crocodile'],  
                ['algae', 'small_fish', 'frog', 'snake', 'hawk'],        
                ['grass', 'worm', 'mouse', 'snake', 'crocodile'],       
                ['grass', 'worm', 'mouse', 'snake', 'hawk'],            
                ['grass', 'grasshopper', 'mouse', 'snake', 'crocodile'],
                ['grass', 'grasshopper', 'mouse', 'snake', 'hawk']      
            ]
        };

        const ZONE_LABELS = ['Ø§Ù„Ù…Ù†ØªØ¬', 'Ù…Ø³ØªÙ‡Ù„Ùƒ Ø£ÙˆÙ„', 'Ù…Ø³ØªÙ‡Ù„Ùƒ Ø«Ø§Ù†Ù', 'Ù…Ø³ØªÙ‡Ù„Ùƒ Ø«Ø§Ù„Ø«', 'Ù…Ø³ØªÙ‡Ù„Ùƒ Ø±Ø§Ø¨Ø¹'];
        let originalItems = "";

        // ------------------------------------------------------------------
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© (Ø§Ù„Ù‚Ù„ÙˆØ¨ØŒ Ø§Ù„Ø£Ø²Ø±Ø§Ø±ØŒ Ø§Ù„ÙˆÙ‚ØªØŒ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„)
        // ------------------------------------------------------------------
        function showMessage(msg, classes) {
            messageBox.textContent = msg;
            messageBox.className = classes + ' text-lg p-3 rounded-lg font-bold block border shadow-sm';
        }

        function updateLivesUI() {
            const container = document.getElementById('lives-container');
            container.innerHTML = '';
            for (let i = 0; i < 3; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="${i < lives ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-500 transition-all duration-300 ${i >= lives ? 'opacity-30 scale-75' : ''}"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>`;
                container.appendChild(heart);
            }
        }

        function updateLevelButtons() {
            const btn1 = document.getElementById('level1-btn');
            const btn2 = document.getElementById('level2-btn');
            const btn3 = document.getElementById('level3-btn');

            [btn1, btn2, btn3].forEach(btn => btn.classList.remove('bg-green-700', 'bg-indigo-700', 'bg-red-700', 'bg-green-500', 'bg-indigo-500', 'bg-red-500', 'ring-4'));

            if (maxUnlockedLevel >= 2) {
                btn2.disabled = false;
                btn2.classList.remove('opacity-50', 'cursor-not-allowed');
                btn2.innerHTML = 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2 (4 Ø­Ù„Ù‚Ø§Øª)';
            } else {
                btn2.disabled = true;
                btn2.classList.add('opacity-50', 'cursor-not-allowed');
                btn2.innerHTML = 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2 (4 Ø­Ù„Ù‚Ø§Øª) ğŸ”’';
            }

            if (maxUnlockedLevel >= 3) {
                btn3.disabled = false;
                btn3.classList.remove('opacity-50', 'cursor-not-allowed');
                btn3.innerHTML = 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3 (5 Ø­Ù„Ù‚Ø§Øª)';
            } else {
                btn3.disabled = true;
                btn3.classList.add('opacity-50', 'cursor-not-allowed');
                btn3.innerHTML = 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3 (5 Ø­Ù„Ù‚Ø§Øª) ğŸ”’';
            }

            // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø²Ø± Ø§Ù„Ù†Ø´Ø·
            if (CURRENT_LEVEL === 'level1') btn1.classList.add('bg-green-700', 'ring-4', 'ring-green-300');
            else btn1.classList.add('bg-green-500');

            if (CURRENT_LEVEL === 'level2') btn2.classList.add('bg-indigo-700', 'ring-4', 'ring-indigo-300');
            else btn2.classList.add('bg-indigo-500');

            if (CURRENT_LEVEL === 'level3') btn3.classList.add('bg-red-700', 'ring-4', 'ring-red-300');
            else btn3.classList.add('bg-red-500');
        }

        function handleTimeout() {
            playFailureSound();
            loseLife('Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª! â°');
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLimit = CURRENT_LEVEL === 'level1' ? 30 : CURRENT_LEVEL === 'level2' ? 40 : 50;
            timeLeft = timeLimit;
            updateTimeBar();

            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimeBar();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeout();
                }
            }, 1000);
        }

        function updateTimeBar() {
            const bar = document.getElementById('time-bar');
            const text = document.getElementById('time-text');
            const percentage = (timeLeft / timeLimit) * 100;
            
            bar.style.width = `${Math.max(0, percentage)}%`;
            text.textContent = `00:${timeLeft < 10 ? '0' + Math.max(0, timeLeft) : Math.max(0, timeLeft)}`;

            if(percentage > 50) {
                bar.className = 'bg-green-500 h-4 rounded-full transition-all duration-1000 ease-linear';
                text.className = 'text-sm font-bold text-green-700 bg-white px-2 rounded-md shadow-sm border border-green-200';
            } else if(percentage > 20) {
                bar.className = 'bg-yellow-500 h-4 rounded-full transition-all duration-1000 ease-linear';
                text.className = 'text-sm font-bold text-yellow-700 bg-white px-2 rounded-md shadow-sm border border-yellow-200';
            } else {
                bar.className = 'bg-red-500 h-4 rounded-full transition-all duration-1000 ease-linear pulse-animation';
                text.className = 'text-sm font-bold text-red-700 bg-white px-2 rounded-md shadow-sm border border-red-200 pulse-animation';
            }
        }

        function showResultScreen(isWin, reason = '') {
            clearInterval(timerInterval);
            const resultScreen = document.getElementById('result-screen');
            const title = document.getElementById('result-title');
            const message = document.getElementById('result-message');
            const icon = document.getElementById('result-icon');
            const rewardContainer = document.getElementById('reward-container');

            if (isWin) {
                icon.innerHTML = 'ğŸ†';
                title.textContent = 'Ù…Ø¨Ø±ÙˆÙƒ Ø§Ù„ÙÙˆØ²!';
                title.className = 'text-3xl font-extrabold mb-4 text-green-600';
                message.textContent = 'Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø°Ù‡Ù„!';
                resultScreen.querySelector('.bg-white').classList.add('border-green-400');
                resultScreen.querySelector('.bg-white').classList.remove('border-red-400', 'border-white');
                rewardContainer.classList.remove('hidden'); // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„
                playSuccessSound();
                
                // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†Ù
                setTimeout(() => {
                    window.location.href = "https://talented-nation.github.io/database/sreward2.html";
                }, 4000);
            } else {
                icon.innerHTML = 'ğŸ’”';
                title.textContent = 'Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©';
                title.className = 'text-3xl font-extrabold mb-4 text-red-600';
                message.textContent = reason + ' Ù†ÙØ¯Øª Ø¬Ù…ÙŠØ¹ Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ.';
                resultScreen.querySelector('.bg-white').classList.add('border-red-400');
                resultScreen.querySelector('.bg-white').classList.remove('border-green-400', 'border-white');
                rewardContainer.classList.add('hidden'); // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø®Ø³Ø§Ø±Ø©
                playFailureSound();
            }

            resultScreen.classList.remove('hidden');
            resultScreen.classList.add('flex');
        }

        function loseLife(reason) {
            lives--;
            updateLivesUI();
            clearInterval(timerInterval);

            if (lives <= 0) {
                showMessage(reason + ' Ù†ÙØ¯Øª Ø¬Ù…ÙŠØ¹ Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ!', 'bg-red-100 border-red-500 text-red-700 pulse-animation');
                setTimeout(() => {
                    showResultScreen(false, reason);
                }, 2500);
            } else {
                showMessage(reason + ` ØªØ¨Ù‚Øª Ù„Ùƒ ${lives} Ù…Ø­Ø§ÙˆÙ„Ø§Øª. Ø¬Ø±Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹!`, 'bg-red-100 border-red-500 text-red-700');
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙˆØ¨Ø¯Ø¡ Ø§Ù„ÙˆÙ‚Øª Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ù„Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                setTimeout(() => {
                    clearBoard(false); 
                    startTimer();
                }, 2000);
            }
        }

        // ------------------------------------------------------------------
        // ÙˆØ¸Ø§Ø¦Ù ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ§Ù„Ù„Ø¹Ø¨
        // ------------------------------------------------------------------
        function loadLevel(level) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ø§ ÙŠØªØ®Ø·Ù‰ Ø§Ù„Ù‚ÙÙ„
            if (level === 'level2' && maxUnlockedLevel < 2) return;
            if (level === 'level3' && maxUnlockedLevel < 3) return;

            CURRENT_LEVEL = level;
            const chainLength = CORRECT_CHAINS[level][0].length;
            
            document.getElementById('level-description').textContent = `Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${level.slice(-1)}: Ø±ØªØ¨ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ© Ù„ØªÙƒÙˆÙ† Ø³Ù„Ø³Ù„Ø© ØºØ°Ø§Ø¦ÙŠØ© ØµØ­ÙŠØ­Ø© Ù…Ù† ${chainLength} Ø­Ù„Ù‚Ø§Øª.`;
            
            updateLevelButtons();
            updateLivesUI();
            clearBoard(false); // Ù…Ø³Ø­ Ø¨Ø¯ÙˆÙ† Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø­

            dropArea.innerHTML = '';
            dropArea.className = `grid w-full max-w-7xl p-6 bg-white rounded-xl shadow-2xl gap-4 md:gap-8 grid-cols-${chainLength} md:grid-cols-${chainLength}`;

            for (let i = 0; i < chainLength; i++) {
                const zone = document.createElement('div');
                zone.id = `zone-${i + 1}`;
                zone.classList.add('drop-zone', 'flex', 'flex-col', 'items-center', 'justify-center', 'rounded-lg', 'p-4', 'text-center');
                
                zone.innerHTML = `
                    <span class="text-gray-500 text-sm font-bold">${i + 1}. ${ZONE_LABELS[i]}</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 mt-2 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        ${i === 0 ? '<path d="M12 22a2 2 0 0 0 2-2V4a2 2 0 0 0-4 0v16a2 2 0 0 0 2 2z"/><path d="M10 18h4"/><path d="M8 14h8"/><path d="M6 10h12"/><path d="M4 6h16"/>' : '<path d="M18 6L6 18M6 6l12 12"/>'}
                    </svg>
                `;
                addDropListeners(zone);
                dropArea.appendChild(zone);
            }
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
            startTimer();
            messageBox.classList.add('hidden');
        }

        // ------------------------------------------------------------------
        // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ø­Ø¨ (Event Delegation)
        // ------------------------------------------------------------------
        document.body.addEventListener('dragstart', handleDragStartDelegate);
        document.body.addEventListener('dragend', handleDragEnd);

        function getDraggableTarget(target) {
            while (target && !target.classList.contains('draggable') && target !== document.body) {
                target = target.parentNode;
            }
            return target && target.classList.contains('draggable') ? target : null;
        }

        function handleDragStartDelegate(e) {
            const target = getDraggableTarget(e.target);
            if (target) {
                draggedItem = target;
                e.dataTransfer.setData('text/plain', draggedItem.id);
                setTimeout(() => draggedItem.classList.add('opacity-50'), 0);
                playDragSound();
            } else {
                e.preventDefault(); 
            }
        }

        function handleDragEnd(e) {
            if (draggedItem) {
                draggedItem.classList.remove('opacity-50');
                draggedItem = null;
            }
        }
        
        function addDropListeners(zone) {
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                if (draggedItem) {
                    zone.classList.add('active'); 
                    e.dataTransfer.dropEffect = 'move';
                }
            });

            zone.addEventListener('dragleave', (e) => {
                zone.classList.remove('active');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('active');

                const data = e.dataTransfer.getData('text/plain');
                const itemToDrop = document.getElementById(data);

                if (!itemToDrop) return;

                const itemInZone = zone.querySelector('.draggable');
                if (itemInZone) { 
                    showMessage('Ø§Ù„Ù…Ø±Ø¨Ø¹ Ù…Ù…ØªÙ„Ø¦! Ù‚Ù… Ø¨Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£ÙˆÙ„Ø§Ù‹.', 'bg-yellow-100 border-yellow-500 text-yellow-700');
                    return;
                }
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† Ù…ÙƒØ§Ù†Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠ
                const oldParent = itemToDrop.parentNode;
                if (oldParent) {
                    oldParent.removeChild(itemToDrop);
                    if (oldParent.classList.contains('drop-zone')) {
                        const oldPlaceholderSpan = oldParent.querySelector('span:first-child');
                        if(oldPlaceholderSpan) oldPlaceholderSpan.style.opacity = '1';
                        const oldPlaceholderSvg = oldParent.querySelector('svg');
                        if(oldPlaceholderSvg) oldPlaceholderSvg.style.opacity = '1';
                    }
                }
                
                // ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù†ØµØ± ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                zone.appendChild(itemToDrop);
                itemToDrop.classList.remove('p-3', 'w-28', 'h-32', 'flex-col', 'text-center');
                itemToDrop.classList.add('p-2', 'w-full', 'h-auto', 'flex-row', 'justify-center', 'items-center', 'space-x-2');
                
                const spanElement = itemToDrop.querySelector('span');
                if (spanElement) spanElement.classList.add('text-lg');
                
                const imgElement = itemToDrop.querySelector('img');
                if (imgElement) {
                    imgElement.classList.remove('item-image');
                    imgElement.classList.add('w-12', 'h-12');
                }

                zone.querySelector('span:first-child').style.opacity = '0';
                zone.querySelector('svg').style.opacity = '0';

                playDragSound();
            });
        }
        
        // ------------------------------------------------------------------
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
        // ------------------------------------------------------------------
        function checkFoodChain() {
            const currentDropZones = document.querySelectorAll('#drop-area > div'); 
            
            const currentChain = Array.from(currentDropZones).map(zone => {
                const item = zone.querySelector('.draggable');
                return item ? item.getAttribute('data-item') : null;
            });

            const possibleChains = CORRECT_CHAINS[CURRENT_LEVEL];
            const chainLength = possibleChains[0].length;

            if (currentChain.includes(null)) {
                showMessage(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù„Ù‚Ø§Øª Ø§Ù„Ù€ ${chainLength} Ø£ÙˆÙ„Ø§Ù‹!`, 'bg-yellow-100 border-yellow-500 text-yellow-700');
                return;
            }

            let isCorrect = false;

            for (const correctChain of possibleChains) {
                if (currentChain.length !== correctChain.length) continue; 
                const match = currentChain.every((item, index) => item === correctChain[index]);
                if (match) {
                    isCorrect = true;
                    break;
                }
            }

            if (isCorrect) {
                clearInterval(timerInterval); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙˆÙ‚Øª Ø¹Ù†Ø¯ Ø§Ù„ÙÙˆØ²
                let successMessage = '';
                let nextLevel = null;

                if (CURRENT_LEVEL === 'level1') {
                    maxUnlockedLevel = Math.max(maxUnlockedLevel, 2);
                    successMessage = 'Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø³Ù„Ø³Ù„Ø© ØµØ­ÙŠØ­Ø© (3 Ø­Ù„Ù‚Ø§Øª). Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ...';
                    nextLevel = 'level2';
                } else if (CURRENT_LEVEL === 'level2') {
                    maxUnlockedLevel = Math.max(maxUnlockedLevel, 3);
                    successMessage = 'Ø±Ø§Ø¦Ø¹! Ù„Ù‚Ø¯ Ø£ØªÙ‚Ù†Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ (4 Ø­Ù„Ù‚Ø§Øª). Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù„Ø«...';
                    nextLevel = 'level3';
                } else {
                    successMessage = 'Ù…Ø°Ù‡Ù„! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø£ÙƒÙ…Ù„Ù‡Ø§ Ø¨Ù†Ø¬Ø§Ø­! ğŸ†';
                }
                
                updateLevelButtons();
                showMessage(successMessage, 'bg-green-100 border-green-500 text-green-700');
                playSuccessSound();
                
                currentDropZones.forEach(zone => {
                    zone.classList.add('bg-green-200', 'border-green-600', 'animate-pulse');
                    zone.classList.remove('drop-zone');
                });

                if (nextLevel) {
                    setTimeout(() => {
                        loadLevel(nextLevel);
                    }, 4000); // Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†Ù
                } else {
                    setTimeout(() => {
                        showResultScreen(true);
                    }, 3000); // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ÙÙˆØ² Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø£Ø²Ø±Ø§Ø±
                }
            } else {
                playFailureSound();
                loseLife('ØªØ±ØªÙŠØ¨ Ø®Ø§Ø·Ø¦ Ù„Ù„Ø³Ù„Ø³Ù„Ø©!');
            }
        }
    
        // ------------------------------------------------------------------
        // Ø¥ÙØ±Ø§Øº Ø§Ù„Ù„ÙˆØ­Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ (Ø¨Ø¯ÙˆÙ† Ø®Ø³Ø§Ø±Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ùˆ ÙˆÙ‚Øª)
        // ------------------------------------------------------------------
        function clearBoard(showUserMessage = true) {
            const currentDropZones = document.querySelectorAll('#drop-area > div'); 
            currentDropZones.forEach(zone => {
                const itemInZone = zone.querySelector('.draggable');
                if (itemInZone) {
                    draggableArea.appendChild(itemInZone);
                    itemInZone.classList.remove('p-2', 'w-full', 'h-auto', 'flex-row', 'justify-center', 'items-center', 'space-x-2');
                    itemInZone.classList.add('p-3', 'w-28', 'h-32', 'flex-col', 'text-center');
                    
                    const spanElement = itemInZone.querySelector('span');
                    if (spanElement) spanElement.classList.remove('text-lg');
                    
                    const imgElement = itemInZone.querySelector('img');
                    if (imgElement) {
                        imgElement.classList.remove('w-12', 'h-12');
                        imgElement.classList.add('item-image');
                    }
                }
                
                zone.classList.remove('bg-green-200', 'border-green-600', 'animate-pulse');
                zone.classList.add('drop-zone'); 

                const placeholderSpan = zone.querySelector('span:first-child');
                if(placeholderSpan) placeholderSpan.style.opacity = '1';
                const placeholderSvg = zone.querySelector('svg');
                if(placeholderSvg) placeholderSvg.style.opacity = '1';
            });
            
            draggableArea.innerHTML = originalItems; 

            if (showUserMessage) {
                showMessage('ØªÙ… Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø¥Ù„Ù‰ Ø£Ù…Ø§ÙƒÙ†Ù‡Ø§.', 'bg-gray-200 border-gray-400 text-gray-700');
            }
        }

        // ------------------------------------------------------------------
        // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
        // ------------------------------------------------------------------
        window.addEventListener('load', () => {
             originalItems = draggableArea.innerHTML;
             initAudio(); 
             loadLevel(CURRENT_LEVEL);
        });
        
    </script>
</body>
</html>
